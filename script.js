let PcListDate =  [
    {name:"川村 蘭琉亜",rubi:"かわむら らるあ",age:17,height:170,lost:false,img:"no.png",html:"sample.html",status:{STR:13,CON:11,POW:13,DEX:7,APP:11,SIZ:14,INT:15,EDU:11},scenario:["Crazy salt"],spoiler:false,mituuka:false,neta:false},
    {name:"愛洲 悠真",rubi:"あいす はるま",age:18,height:171,lost:false,img:"no.png",html:"sample.html",status:{STR:14,CON:12,POW:16,DEX:7,APP:13,SIZ:12,INT:18,EDU:11,},scenario:["誰がロックを殺すのか"],spoiler:true,mituuka:false,neta:false},
    {name:"赤山 茶可丸",rubi:"あかやま ちゃかまる",age:28,height:165,lost:false,img:"tyakamaru.png",html:"sample.html",status:{STR:9,CON:11,POW:14,DEX:11,APP:16,SIZ:11,INT:17,EDU:14,},scenario:["ソープスクール","SAN値回復温泉旅行","まもなく最終列車がまいります"],spoiler:false,mituuka:false,neta:false,color:203},
    {name:"阿瀬見 朔",rubi:"あせみ さく",age:23,height:140,lost:true,img:"saku.png",html:"sample.html",status:{STR:11,CON:6,POW:16,DEX:17,APP:12,SIZ:8,INT:15,EDU:12},scenario:["キルキルイキル"],spoiler:false,mituuka:false,neta:false,color:219},
    {name:"マヨネーズ<br>きよし",rubi:"",age:33,height:188,lost:false,img:"yonezu.png",html:"sample.html",status:{STR:12,CON:10,POW:13,DEX:14,APP:9,SIZ:13,INT:14,EDU:15},scenario:["毒入りスープ"],spoiler:false,mituuka:false,neta:true},
    {name:"siyakuna4897",rubi:"シヤクナ4897",age:4,height:175,lost:false,img:"siyakuna.png",html:"sample.html",status:{STR:18,CON:18,POW:18,DEX:18,APP:18,SIZ:18,INT:18,EDU:18},scenario:["地獄界神話回り"],spoiler:false,mituuka:false,neta:true},
    {name:"茅栗 䢗",rubi:"かやぐり きょく",age:21,height:170,lost:false,img:"kayaguri.png",html:"sample.html",status:{STR:11,CON:12,POW:13,DEX:11,APP:18,SIZ:14,INT:16,EDU:20},scenario:["ワンルーム・ディスコン","ハートフルワンダーランド","残り2分","アンヴォイダブルツアー"],spoiler:false,mituuka:false,neta:false,color:192},
    {name:"アンタレス",rubi:"",age:1,height:148,lost:false,img:"antaresu.png",html:"sample_antaresu.html",status:{STR:6,CON:9,POW:17,DEX:9,APP:16,SIZ:9,INT:16,EDU:18},scenario:["かいぶつたちとマホラカルト"],spoiler:false,mituuka:false,neta:false,color:240},
    {name:"瑠璃",rubi:"るり",age:10000,height:160,lost:false,img:"ruri.png",html:"sample.html",status:{STR:14,CON:15,POW:14,DEX:11,APP:18,SIZ:11,INT:13,EDU:19},scenario:["Good morning ALL"],spoiler:false,mituuka:false,neta:false,color:187},
    {name:"アンラック<br>＝ナチャ",rubi:"",age:16,height:175,lost:false,img:"no.png",html:"sample.html",status:{STR:18,CON:13,POW:12,DEX:11,APP:8,SIZ:15,INT:16,EDU:16},scenario:["別にアンタのことなんか好きじゃないんだからね！"],spoiler:false,mituuka:false,neta:true},
    {name:"雨障 雫",rubi:"あまつつみ しずく",age:13,height:150,lost:false,img:"no.png",html:"sample.html",status:{STR:15,CON:9,POW:7,DEX:16,APP:14,SIZ:10,INT:15,EDU:12},scenario:["From madness to dear monsters"],spoiler:false,mituuka:false,neta:false},
    {name:"野分 数多",rubi:"のわけ あまた",age:21,height:156,lost:false,img:"no.png",html:"sample.html",status:{STR:8,CON:8,POW:16,DEX:18,APP:17,SIZ:11,INT:16,EDU:9},scenario:["スススス"],spoiler:false,mituuka:false,neta:false},
    {name:"俳色 怪鴟",rubi:"はいいろ よたか",age:21,height:152,lost:false,img:"no.png",html:"sample.html",status:{STR:10,CON:5,POW:9,DEX:12,APP:16,SIZ:9,INT:13,EDU:14},scenario:["Zai"],spoiler:false,mituuka:false,neta:false},
    {name:"白氷無 翔良",rubi:"しらひな かけら",age:23,height:155,lost:false,img:"sirahina.png",html:"sample.html",status:{STR:15,CON:9,POW:13,DEX:17,APP:13,SIZ:10,INT:15,EDU:14},scenario:["鰯と柊"],spoiler:true,mituuka:false,neta:false,color:193},
    {name:"天竺桂 月兎",rubi:"たぶのき つきと",age:23,height:152,lost:false,img:"no.png",html:"sample.html",status:{STR:15,CON:11,POW:15,DEX:18,APP:16,SIZ:10,INT:12,EDU:19},scenario:["花嫁の哀眼"],spoiler:false,mituuka:false,neta:false},
    {name:"夕鳶 渡",rubi:"ゆうとび わたる",age:18,height:156,lost:false,img:"no.png",html:"sample.html",status:{STR:16,CON:18,POW:13,DEX:17,APP:12,SIZ:11,INT:15,EDU:11},scenario:["さよならを言いにきた"],spoiler:false,mituuka:false,neta:false},
    {name:"花信 颪",rubi:"かしん おろし",age:34,height:165,lost:false,img:"kasin.png",html:"sample.html",status:{STR:8,CON:15,POW:14,DEX:13,APP:13,SIZ:12,INT:18,EDU:18},scenario:["庭師は何を口遊む"],spoiler:false,mituuka:false,neta:false,color:245},
    {name:"Luna・Clark",rubi:"ルナ・クラーク",age:26,height:157,lost:false,img:"luna.png",html:"sample.html",status:{STR:14,CON:8,POW:13,DEX:16,APP:16,SIZ:11,INT:15,EDU:15},scenario:["嗤う人間師"],spoiler:false,mituuka:false,neta:false,color:203},
    {name:"蓮吟 玄兎",rubi:"れんぎん げんと",age:15,height:153,lost:false,img:"gentoicon.png",html:"sample.html",status:{STR:6,CON:14,POW:14,DEX:16,APP:11,SIZ:10,INT:15,EDU:12},scenario:["海も枯れるまで"],spoiler:false,mituuka:false,neta:false,color:203},
    {name:"岡野 多芥子",rubi:"おかの たけし",age:45,height:175,lost:false,img:"okano.png",html:"sample.html",status:{STR:10,CON:9,POW:18,DEX:12,APP:12,SIZ:12,INT:17,EDU:19},scenario:[""],spoiler:false,mituuka:true,neta:true},
    {name:"小雀 子星",rubi:"こがら ねぼし",age:-1,height:141,lost:false,img:"no.png",html:"sample.html",status:{STR:8,CON:13,POW:14,DEX:17,APP:14,SIZ:8,INT:15,EDU:17},scenario:["VOID"],spoiler:true,mituuka:true,neta:false},
]
let spoilerOff =[]
for(i = 0;i < PcListDate.length; i++){
    let new_element = document.createElement('div');
    new_element.className = "index-pc"
    new_element.dataset.noUseHid = PcListDate[i].mituuka
    new_element.dataset.netaHid = PcListDate[i].neta
    new_element.setAttribute("id", PcListDate[i].name);
    let NameColer = ``
    if(PcListDate[i].mituuka) NameColer = `style="color: #0088ff6f;"`
    if(PcListDate[i].neta) NameColer = `style="color: #ff9e00;"`
    new_element.insertAdjacentHTML('beforeend',`
        <div class="pc-tab">
    <input type="radio" name="PcList" id="pc${i}" data-pcindex="${i}" class="tab-inp inp-${PcListDate[i].name}" data-html="${PcListDate[i].html}"><div class="pc-tab-list">
    <label for="pc${i}"> <img src="imge/${PcListDate[i].img}" class="img-${PcListDate[i].name}" alt="${PcListDate[i].name}のアイコン" width="100px"></label>
    <div class="tab-txt"> <span class="tab-scenario-name">${PcListDate[i].scenario[0]}<br></span>
    <label for="pc${i}" class="tab-name" ${NameColer}><ruby> ${PcListDate[i].name}<rt>${PcListDate[i].rubi}</rt></ruby></label> </div>
    <div class="tab-bar"></div>
    </div></div>
    `)
    document.getElementById('list').prepend(new_element)
}
document.querySelector(".inp-瑠璃").addEventListener("change",function(){
    console.log("henka ")
    const imgSrc = document.querySelector(".img-瑠璃")
    if(document.querySelector(".inp-瑠璃").checked){
        imgSrc.src = "imge/ruripiasu.png"
    }
})
document.querySelectorAll(".tab-inp").forEach(v => v.addEventListener("change", (e) => {
    console.log(e.target.dataset.html)
    if(!e.target.classList.contains("inp-瑠璃"))document.querySelector(".img-瑠璃").src = "imge/ruri.png"
    fetch("html/" + e.target.dataset.html)
            .then(response => response.text())
            .then(data => {
                document.getElementById('pc-dsp').innerHTML = data;
                if(e.target.dataset.html.includes('sample'))  var set_interval_id = setInterval(findTargetElement, 100);
                function findTargetElement() {//さんぷる
                 // 要素を見つける処理
                console.log("捜索中")
                var pcIndex = e.target.dataset.pcindex
                 if(document.getElementsByClassName("page-body")[0]) {//サンプル表示変更
                    document.getElementsByClassName("name")[0].innerHTML = PcListDate[pcIndex].name
                    document.getElementsByClassName("name")[1].innerHTML = PcListDate[pcIndex].name + `<rt>${PcListDate[pcIndex].rubi}</rt>`
                    document.getElementsByClassName("height")[0].innerHTML = PcListDate[pcIndex].height
                    if(!document.getElementsByClassName("icon")[0].data.img) document.getElementsByClassName("icon")[0].style.background = `url(imge/${PcListDate[pcIndex].img}) 0% 0% / cover no-repeat`;
                    if(!PcListDate[pcIndex].spoiler||spoilerOff.includes(PcListDate[pcIndex].scenario[0] + "HO")||spoilerOff.includes(PcListDate[pcIndex].scenario[0])){//ネタバレ防止
                        document.getElementById('STR').innerHTML = "STR:" + PcListDate[pcIndex].status.STR
                        document.getElementById('CON').innerHTML = "CON:" + PcListDate[pcIndex].status.CON
                        document.getElementById('POW').innerHTML = "POW:" + PcListDate[pcIndex].status.POW
                        document.getElementById('DEX').innerHTML = "DEX:" + PcListDate[pcIndex].status.DEX
                        document.getElementById('APP').innerHTML = "APP:" + PcListDate[pcIndex].status.APP
                        document.getElementById('SIZ').innerHTML = "SIZ:" + PcListDate[pcIndex].status.SIZ
                        document.getElementById('INT').innerHTML = "INT:" + PcListDate[pcIndex].status.INT
                        document.getElementById('EDU').innerHTML = "EDU:" + PcListDate[pcIndex].status.EDU
                    }
                   clearInterval(set_interval_id);
                 }
                }
            })
            .catch(error => {
                console.error("There was an error loading the content:", error);
            });
  }));
  if(localStorage.getItem('spoilerSaveData')){
console.log(localStorage.getItem('spoilerSaveData').split(','))
let spoilerSaveData = localStorage.getItem('spoilerSaveData').split(',');
spoilerOff = spoilerSaveData
for(i=0;i < spoilerSaveData.length; i++){
    if(!document.querySelector(`[data-scenario="${spoilerSaveData[i]}"]`))continue
    document.querySelector(`[data-scenario="${spoilerSaveData[i]}"]`).checked = true
}
}


document.getElementById("index-selest").addEventListener("change", function(){//探索者リストの順番
    var Svalue =  this[this.selectedIndex].value;
    for(i = 0;i < PcListDate.length; i++){
        let pcdata = PcListDate[PcListDate.length-1-i]
        document.querySelectorAll(".index-pc")[i].style.display = "block"
        if(Svalue === "new"){
            document.querySelectorAll(".index-pc")[i].style.order = i;
        }
        if(Svalue === "height"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.height;
        }
        if(Svalue === "age"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.age;
            if(pcdata.age === -1) document.querySelectorAll(".index-pc")[i].style.display = "none"
        }
        if(Svalue === "color"){
            if(pcdata.hasOwnProperty('color')){
                document.querySelectorAll(".index-pc")[i].style.order = pcdata.color;
            }else{
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }
        if(Svalue === "str"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.STR;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "con"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.CON;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "pow"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.POW;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "dex"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.DEX;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "app"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.APP;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "siz"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.SIZ;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "int"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.INT;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        if(Svalue === "edu"){
            document.querySelectorAll(".index-pc")[i].style.order = pcdata.status.EDU;
            if(pcdata.spoiler && !spoilerOff.includes(pcdata.scenario[0])){
                if(!spoilerOff.includes(pcdata.scenario[0] + "HO")){
                document.querySelectorAll(".index-pc")[i].style.display = "none"
            }
        }}
        
}
})
document.querySelectorAll(".spoiler-btn").forEach(v => v.addEventListener("change", (e) => {//ネタバレ選択
if(e.target.checked){
    spoilerOff.push(e.target.dataset.scenario)
}else{
    spoilerOff.splice(spoilerOff.indexOf(e.target.dataset.scenario), 1)
}
localStorage.setItem('spoilerSaveData',spoilerOff)
console.log(spoilerOff)
spStyle()
}));

document.getElementById('mituuka-disp').addEventListener("change", function(){//
    for(i = 0;i < PcListDate.length; i++){
    if(document.getElementById('mituuka-disp').checked){
        document.querySelectorAll(".index-pc")[i].dataset.noUseHid = false
    }else{
        let pcdata = PcListDate[PcListDate.length-1-i]
            document.querySelectorAll(".index-pc")[i].dataset.noUseHid = pcdata.mituuka
    }
}
})
document.getElementById('neta-disp').addEventListener("change", function(){//
    for(i = 0;i < PcListDate.length; i++){
    if(document.getElementById('neta-disp').checked){
        document.querySelectorAll(".index-pc")[i].dataset.netaHid = false
    }else{
        let pcdata = PcListDate[PcListDate.length-1-i]
            document.querySelectorAll(".index-pc")[i].dataset.netaHid = pcdata.neta
    }
}
})

let spScenario = document.querySelectorAll('.spoiler-btn');
let spScenarioTxt = []
for(i = 0;i < spScenario.length; i++){
    spScenarioTxt.push("." + spScenario[i].dataset.scenario + "-hid")
}
function spStyle(){//ネタバレ要素非表示表示
    let spStyleTxt = []
    for(i = 0;i < spoilerOff.length; i++){
        spStyleTxt.push("." + spoilerOff[i] + "-hid")
    }
    document.getElementById("sp-style").innerHTML = `
    ${spScenarioTxt}{display: none;}
    ${spStyleTxt}{display: block;}`
    return spStyleTxt
}
spStyle()
